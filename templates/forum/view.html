{{define "profileLink"}}
    <a href="/profile/view/{{.Id}}">{{.Login}}</a>
{{end}}
{{define "profilePicture"}}
    <img src="/profile/picture/{{.Id}}" alt="{{.Login}}" width=100/>
{{end}}
{{define "profilePictureLink"}}
    <a href="/profile/view/{{.Id}}">
        {{template "profilePicture" .}}
    </a>
{{end}}
{{define "navListItem"}}
    {{if .Login}}
        <li>{{.Messages.WelcomeLabel}} {{template "profileLink" .}}</li>
        <li><a href="/settings">{{.Messages.PageTitleSettings}}</a></li>
        {{if .ViewAdmin}}
            <li><a href="/admin">{{.Messages.PageTitleAdmin}}</a></li>
        {{end}}
        <li><a href="{{.LoginUrl}}">{{.Messages.LogoutLinkLabel}}</a></li>
    {{else}}
        <li><a href="{{.LoginUrl}}">{{.Messages.LoginLinkLabel}}</a></li>
    {{end}}
{{end}}
<!doctype html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <title>PuzzleTest - {{.PageTitle}}</title>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
        <link href="/static/css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"/>
        
    </head>
    <body>
        <div class="navbar-fixed">
            <nav class="nav-extended white" role="navigation">
                <div class="nav-wrapper container">
                    <a id="logo-container" href="/" class="brand-logo">PuzzleTest</a>
                    {{if .LoginUrl}}
                        <ul class="right hide-on-med-and-down">
                            {{template "navListItem" .}}
                        </ul>
                        <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>
                    {{end}}
                    <div class="col s12">
                        <a href="/" class="breadcrumb">PuzzleTest</a>
                        {{range .Ariane}}
                            <a href="{{.Url}}" class="breadcrumb">{{.Name}}</a>
                        {{end}}
                    </div>
                </div>
                <div class="nav-content">
                    <ul class="tabs tabs-transparent">
                        {{range .SubPages}}
                            <li class="tab"><a href="{{.Url}}">{{.Name}}</a></li>
                        {{end}}
                    </ul>
                </div>
            </nav>
        </div>
        {{if .LoginUrl}}
            <ul id="nav-mobile" class="sidenav">
                {{template "navListItem" .}}
            </ul>
        {{end}}
        <div id="index-banner" class="section no-pad-bot">
            <div class="container">
                <br><br>
                <h1 class="header center teal-text text-lighten-2">{{.PageTitle}}</h1>
                {{with .ErrorMsg}}
                    <div class="row center">
                        <h5 class="header col s12 light materialize-red-text">{{.}}</h5>
                    </div>
                {{end}}
                <br><br>
            </div>
        </div>
        <div class="container">
            <div class="section">
                <h2>
{{.Thread.Text}}
[<a href="{{.BaseUrl}}">{{.Messages.CancelLinkLabel}}</a>]
</h2>
<div class="search">
<form action="{{.CurrentUrl}}" method="GET">
<div>
<label>
{{.Messages.FilterLabel}}
<input type="text" name="filter"/>
</label>
</div>
<div class="hiddendiv">
<input type="text" name="pageNumber" value="1"/>
</div>
<div><button type="submit">{{.Messages.FilterLinkLabel}}</button></div>
</form>
</div>
<div class="pagination">
{{if .PreviousPageNumber}}
<form action="{{.CurrentUrl}}" method="GET">
<div class="hiddendiv">
<input type="text" name="pageNumber" value="{{.PreviousPageNumber}}"/>
{{if .Filter}}
<input type="text" name="filter" value="{{.Filter}}"/>
{{end}}
</div>
<div><button type="submit">{{.Messages.PreviousPageLinkLabel}}</button></div>
</form>
{{end}}
{{if .NextPageNumber}}
<form action="{{.CurrentUrl}}" method="GET">
<div class="hiddendiv">
<input type="text" name="pageNumber" value="{{.NextPageNumber}}"/>
{{if .Filter}}
<input type="text" name="filter" value="{{.Filter}}"/>
{{end}}
</div>
<div><button type="submit">{{.Messages.NextPageLinkLabel}}</button></div>
</form>
{{end}}
</div>
{{$threadId := .Thread.Id}}
{{if .AllowedToCreate}}
<form id="createForumMessageForm" action="{{.BaseUrl}}message/save/{{$threadId}}" method="POST">
<div><textarea id="forumMessageField" name="message" rows="20" cols="80">{{.Messages.ResponseMessageLabel}}</textarea></div>
<div class="hiddendiv">
{{/* to allow JavaScript or WebAssembly to detect unmodified localized message */}}
<span id="unmodifiedMessage">{{.Messages.ResponseMessageLabel}}</span>
{{/* to allow JavaScript or WebAssembly to display a localized error message */}}
<span id="errorEmptyForumMessageMessage">{{.Messages.EmptyForumMessage}}</span>
</div>
<div><button type="button" id="createForumMessageButton">{{.Messages.CreateLinkLabel}}</button></div>
</form>
{{end}}
<ul>
{{$baseUrl := .BaseUrl}}
{{if .AllowedToDelete}}
{{$deleteLinkLabel := .Messages.DeleteLinkLabel}}
{{range .ForumMessages}}
<li>
<ul>
<li>{{template "profilePictureLink" .Creator}}</li>
<li>{{.Date}}</li>
<li>{{.Text}}</li>
<li><a href="{{$baseUrl}}message/delete/{{$threadId}}/{{.Id}}">{{$deleteLinkLabel}}</a></li>
</ul>
</li>
{{end}}
{{else}}
{{range .ForumMessages}}
<li>
<ul>
<li>{{template "profilePictureLink" .Creator}}</li>
<li>{{.Date}}</li>
<li>{{.Text}}</li>
</ul>
</li>
{{end}}
{{end}}
</ul>

            </div>
        </div>
        <footer class="page-footer teal">
            <div class="footer-copyright">
                <div class="container">
                    Made with <a class="brown-text text-lighten-3" href="https://github.com/dvaumoron/puzzleweb">PuzzleWeb</a> and <a class="brown-text text-lighten-3" href="http://materializecss.com">Materialize</a>
                </div>
            </div>
        </footer>
        <script src="/static/js/wasm_exec.js"></script>
        <script src="/static/js/wiki_link.js"></script>
        <script src="/static/js/materialize.min.js"></script>
        <script src="/static/js/main.js"></script>
    </body>
</html>
